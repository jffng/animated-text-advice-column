<!DOCTYPE html>
<html>
<head>
	<title>Convo Submit</title>
	<style type="text/css">
		body {
			font-family: Helvetica;
		}
		input[type="text"] {
			margin-left:20px;
			width: 200px;
		}
		input[type="radio"] {
			margin-left: 20px;
/*			margin-right: 20px;
*/		}
		.message {

		}
		.generate {
			margin-left: 100px;
		}
		#the-form {
			width: 100%;
		}
	</style>
	</head>
<body>
	<h1>
		Animated Text: Advice Column Gif Generator
	</h1>
	<h3>
		Enter the conversation, in order, with this form! 
	</h3>
	<div>
		<form id="the-form">
			<div class="message" id="line-0">
				<input type="radio" value="receiver" name="who-0">From You
				<input type="radio" value="sender" name="who-0" checked>From Me
				<input type="text" placeholder="message goes here">
				<button class="delete">Delete line</button>	
			</div>
		</form>
		<br>
		<button class="add-line">+ Message</button>
		<button class="add-gif">+ Gif</button>
		<button class="generate">Generate Gif!</button>
	</div>
	<script type="text/javascript" src="lib/p5.min.js"></script>
	<script type="text/javascript" src="lib/p5.gif.min.js"></script>
	<script type="text/javascript" src="lib/bower_components/jquery/dist/jquery.min.js"></script>
	<script type="text/javascript" src="sketch.js"></script>
	<script type="text/javascript">
	var lineCounter = 0;
	var myp5, conversation;

	$('.delete').click(function(e){
		e.preventDefault();
		$(this).parent().remove();
		lineCounter--;
	});

	$('.add-line').click(function(e){
		lineCounter++;

		var newMessage = '<div class="message" id=line-'+lineCounter+'><input type="radio" name="who-'+lineCounter+'" value="receiver">From You <input type="radio" value="sender" name="who-'+lineCounter+'" checked>From Me<input type="text" placeholder="message goes here"><button class="delete">Delete line</button></div>';
		$('#the-form').append(newMessage);

		$('#line-'+lineCounter).children('.delete').click(function(e){
			e.preventDefault();
			$(this).parent().remove();
			lineCounter--;
		});
	});

	$('.generate').click(function(e){
		// array to be handled by the p5 sketch 
		conversation = [];
		$('#the-form').children('.message').each(function(e){
			var message = {
				type: $(this).children('input:checked').val(),
				message: $(this).children('input:text').val()
			}

			// new message objects are pushed to the array
			conversation.push(message);
		});

		if (myp5) myp5.remove();
		myp5 = new p5(sketch);
	});


	</script>
</body>
</html>